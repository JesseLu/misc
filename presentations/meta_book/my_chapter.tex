% Some custom commands.
\newcommand{\BE}{\begin{equation}}
\newcommand{\EE}{\end{equation}}
\newcommand{\BA}{\begin{eqnarray}}
\newcommand{\EA}{\end{eqnarray}}
\newcommand{\curl}{\nabla\times}
\newcommand{\minimize}[1]{\JLUminimize_{#1}\;&}
\newcommand{\subto}{\text{subject to}\;&}

% Custom figures.
\newcommand{\myfig}[2]{\begin{figure}[!h]\includegraphics[width=0.95\textwidth]{fig/#1.jpg}\caption{#2}\label{fig:#1}\end{figure}}

\newcommand{\BI}{\begin{itemize}\item}
\renewcommand{\I}{\item}
\newcommand{\EI}{\end{itemize}}

\newcommand{\ER}[1]{\eqref{eq:#1}}
\newcommand{\SR}[1]{Section~\ref{sec:#1}}
\newcommand{\sR}[1]{section~\ref{sec:#1}}
\newcommand{\FR}[1]{Figure~\ref{fig:#1}}
\newcommand{\fR}[1]{figure~\ref{fig:#1}}
\chapter{Objective-First Nanophotonic Design}
\label{intro}

\abstract{We introduce an ``objective-first'' strategy 
    for designing nanophotonic devices,
    and we demonstrate the design of nanophotonic
    coupler, cloak, and mimic devices.}
    

Our initial foray into design methods for nanophotonic devices
    began with a very simple and naive question: that is,
    if, when presented with a nanophotonic structure,
    we can solve for the electromagnetic fields it produces;
    then, why don't we just make an inverse solver which,
    when given the electromagnetic fields we desire,
    returns the nanophotonic structure that will produce them? %ref.
In other words, since we already know how to solve for $E$ and $H$ 
    in Maxwell's equations, why can't we solve for $\epsilon$
    or even $\mu$ instead?

Not surprisingly, it did not take us long to find that such
    a simple strategy would inevitably run into many problems.

Over the subsequent years, we were able to come up with a better solution,
    which we call an ``objective-first'' strategy for nanophotonic design,
    and which we present in this chapter.
Although it is much more advanced than our original idea,
    objective-first design still carries the same fundamental concept;
    which is to specify the electromagnetic fields, and then
    to solve for a structure to produce them.
    
In this chapter, we present the simple theoretical underpinnings of 
    objective-first design in the first two sections,
    and then show examples of the method in action in the rest of the chapter.
We also include the source code that was used to generate
    all results presented herein. %ref!
    

\input{wave_eq}
\input{ob1}
\input{wg}
\input{cloak}
\input{mimic}

\section{Extending the method}
The objective-first method, as applied in the examples in this chapter,
    really only represent a small foray into the area of nanophotonic design.
Several key extensions to what is presented here are needed to
    fully address real-world nanophotonic design challenges.

\subsection{3D}
The first of these is the need to design fully three-dimensional structures.
Doing so provides no inherent difficulties aside from the matrices in
    \ER{Ab} becoming very large.
This is not insurmountable as electromagnetic simulation software for 
    three-dimensional nanophotonic structures already exists.

Also software to solve \ER{Bd} in three-dimensions does not exist,
    the size of matrix $B(x)$ can be greatly compressed by considering
    only fabrication processes which modify a structure in-plane.
Thus, the degrees of freedom in $p$ can be greatly reduced and the original
    methods used in this chapter can still be applied.
    
\subsection{Multi-mode}
A second necessary extension is to be able to consider the multiple fields
    that a structure produces.
This includes fields of different frequencies and inputs.

\subsection{Robustness}
\subsection{Binary structure}

